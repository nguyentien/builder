/**
 * CoffeeBuilder - v0.1.0 - 2012-10-16
 * Copyright (c) 2006-2012  CoffeeCup Software, Inc. (http://www.coffeecup.com/)
 */
!function(e,t,n){"use strict";var r=function(){this.length=0,this.keys=[],this.items={}};r.prototype={constructor:r,add:function(t,n){return e.inArray(t,this.keys)!==-1&&e.error("Index already defined: "+t),this.keys.push(t),this.items[t]=n,this.length++,this.items[t]},remove:function(e){var t=this.getIndex(e),n=this.items[t.named];return this.keys.splice(t.numeric,1),delete this.items[t.named],this.length--,n},get:function(e){return this.items[this.getIndex(e).named]},getIndex:function(e){return typeof e=="number"?{numeric:e,named:this.getKeyForIndex(e)}:{numeric:this.getIndexForKey(e),named:e}},getKeyForIndex:function(t){if(typeof t=="number"&&t===+t&&t===(t|0)&&t>=0&&t<this.length)return this.keys[t];e.error("Invalid index provided: "+t)},getIndexForKey:function(t){var n=e.inArray(t,this.keys);if(n!==-1)return n;e.error("Invalid index provided: "+t)}};var i=function(t,i){this.options=i||{},this.manifest=this.options.manifest||{},this.width=this.options.width||332,this.design_mode=this.options.design_mode||!1,this.panels=new r,this.current=n,t.length!==1&&e.error("CoffeeBuilder requires exactly one iframe"),this.$element=t,this.$contents=this.$element.contents(),this.$center=e("#layout-center"),this.$controls=e('<div class="ui-layout-east" id="controls">'),this.$controlset=e('<form id="controlset" class="tabsform" method="get" action=""></form>'),this.$switcher=e('<ul id="control_switcher">'),this.$prev=e('<div id="control_prev">').click(e.proxy(this,"prev")),this.$next=e('<div id="control_next">').click(e.proxy(this,"next")),this.$blocker=e('<div id="builder_blocker">').css("width",this.width),this.toggleDesignMode(this.design_mode),this.build()};i.prototype={constructor:i,build:function(){var n=this;return e.each(["$next","$prev","$switcher","$controlset"],function(e,t){n.$controls.append(n[t])}),e.each(["$controls","$blocker"],function(e,t){n.$center.after(n[t])}),n.addPanels(),e(t).resize(e.proxy(n.windowResize,n)).resize(),n},windowResize:function(e){return l.get("window_resize")(e,this)},change:function(){e.each(this.panels.items,function(e,t){t.change()})},refresh:function(t){var r=this;r.$contents=r.$element.contents();if(t===n){r.change();return}e.each(r.panels.items,function(e,t){r.removePanel(e)}),r.manifest=t,r.addPanels()},activatePanelByElement:function(e){var t=this.findPanelWithElementControl(e);t.panel!==n&&(this.activatePanel(t.panel),t.subpanel!==n&&this.panels.get(t.panel).activatePanel(t.subpanel))},findPanelWithElementControl:function(t){var r={panel:n,subpanel:n};return e.each(this.panels.items,function(e,i){if((r=i.findElementControl(t)).panel!==n)return!1}),r},disable:function(){this.$blocker.show()},enable:function(){this.$blocker.hide()},addPanel:function(e,t){this.panels.add(e,(new s(e,t)).build(this)),this.current===this.panels.length-2&&this.$next.addClass("active")},addSubPanel:function(e,t,n){this.panels.get(e).addSubPanel(this,t,n)},addControlToPanel:function(e,t,n){this.panels.get(e).addControl(this,t,n)},addControlToSubPanel:function(e,t,n,r){this.panels.get(e).addControlToPanel(this,t,n,r)},addPanels:function(){var t=this;t.manifest.panels||e.error("Invalid manifest: no panels provided"),t.panels.length&&e.error("`CoffeeBuilder.addPanels` should only be used when no panels exist"),e.each(t.manifest.panels,function(e,n){t.addPanel(e,n)}),t.activatePanel(0)},removePanel:function(e){var t=this.panels.getIndex(e);this.current===t.numeric&&(this.canPrev()?this.prev():this.canNext()?this.next():this.current=n),this.panels.remove(e).destroy(this),this.current!==n&&this.setActive(this.current>t.numeric?this.current-1:this.current)},removeSubPanel:function(e,t){this.panels.get(e).removePanel(this,t)},removeControlFromPanel:function(e,t){this.panels.get(e).removeControl(t)},removeControlFromSubPanel:function(e,t,n){this.panels.get(e).removeControlFromPanel(t,n)},activatePanel:function(t){if(t instanceof e)return this.activatePanelByElement(t);this.current!==n&&this.panels.get(this.current).deactivate(),this.setActive(t)},activateSubPanel:function(e){this.panels.get(this.current).activatePanel(e)},setActive:function(e){this.current=this.panels.getIndex(e).numeric,this.$next.toggleClass("active",this.canNext()),this.$prev.toggleClass("active",this.canPrev()),this.panels.get(e).activate()},prev:function(){this.canPrev()&&this.activatePanel(this.current-1)},next:function(){this.canNext()&&this.activatePanel(this.current+1)},canPrev:function(){return this.current>0},canNext:function(){return this.current<this.panels.length-1},toggleDesignMode:function(t){var r=this;r.design_mode=t===n?!r.design_mode:Boolean(t),r.design_mode?r.$contents.find("*").bind("click.coffeeBuilder",function(t){return t.preventDefault(),r.activatePanelByElement(e(this)),!1}):r.$contents.find("*").unbind("click.coffeeBuilder")}};var s=function(t,i){this.manifest=i,this.name=t,this.panels=new r,this.current=n,this.controls=new r,this.$title=e('<li id="'+this.name+'">').text(this.manifest.name),this.$controls=e('<div id="'+this.name+'_controls" class="controlpane">'),this.$fieldset=e('<fieldset class="panelset">'),this.$subswitcher=e('<ul class="control_toolbar" id="'+this.name+'_subpanel">'),this.manifest.name||e.error("Invalid manifest: no name provided")};s.prototype={constructor:s,build:function(t){var n=this;return t.$switcher.append(n.$title),n.manifest.subpanels?(t.$switcher.after(n.$subswitcher),e.each(n.manifest.subpanels,function(e,r){n.addSubPanel(t,e,r)}),n):(t.$controlset.append(n.$controls),n.$controls.append(n.$fieldset),n.manifest.customizations&&e.each(n.manifest.customizations,function(e,r){n.addControl(t,e,r)}),n)},destroy:function(t){this.$title.remove(),this.$controls.remove(),this.$subswitcher.remove(),e.each(this.panels.items,function(e,n){n.destroy(t)})},addControl:function(e,t,n){this.controls.add(t,f.get(e,this,t,n).build())},addControlToPanel:function(e,t,n,r){return this.panels.get(t).addControl(e,n,r)},removeControl:function(e){this.controls.get(e).$element.remove()},addSubPanel:function(e,t,n){this.panels.add(t,(new o(t,n)).build(e,this)),l.get("subpanels_change")(e,this)},change:function(){e.each(this.controls.items,function(e,t){t.change()}),e.each(this.panels.items,function(e,t){t.change()})},activate:function(){this.$title.addClass("active"),this.controls.length?this.$controls.addClass("active"):this.panels.length&&(this.$subswitcher.addClass("active"),typeof this.current!="number"&&this.activatePanel(0))},deactivate:function(){this.$title.removeClass("active"),this.controls.length?this.$controls.removeClass("active"):this.panels.length&&(this.$subswitcher.removeClass("active"),this.current!==n&&(this.panels.get(this.current).deactivate(),this.current=n))},findElementControl:function(t){var r=this,i={panel:n,subpanel:n};return r.controls.length?e.each(r.controls.items,function(e,n){if(n.hasElement(t))return i.panel=r.name,!1}):r.panels.length&&(i=r.findPanelWithElementControl(t)).panel!==n&&(i={panel:r.name,subpanel:i.panel}),i},removePanel:function(e,t){i.prototype.removePanel.call(this,t),l.get("subpanels_change")(e,this)},setActive:function(e){this.current=this.panels.getIndex(e).numeric,this.panels.get(e).activate()},findPanelWithElementControl:i.prototype.findPanelWithElementControl,removeControlFromPanel:i.prototype.removeControlFromPanel,activatePanel:i.prototype.activatePanel,prev:i.prototype.prev,next:i.prototype.next,canPrev:i.prototype.canPrev,canNext:i.prototype.canNext};var o=function(e,t){s.call(this,e,t)};o.prototype=e.extend({},s.prototype,{constructor:o,build:function(t,n){var r=this;return r.$title.attr("id",n.name+"_subpanel_"+r.name+"_title").click(function(){n.activatePanel(r.name)}),n.$subswitcher.append(r.$title),r.$controls.attr("id",n.name+"_subpanel_"+r.name+"_controls"),t.$controlset.append(r.$controls),r.$fieldset.attr("class","sub_panelset"),r.$controls.append(r.$fieldset),r.manifest.customizations&&e.each(r.manifest.customizations,function(e,n){r.addControl(t,e,n)}),r},activate:function(){this.$title.addClass("active"),this.$controls.addClass("active")},deactivate:function(){this.$title.removeClass("active"),this.$controls.removeClass("active")}});var u=function(t,n,r,i,s){this.builder=t,this.panel=n,this.name=r,this.manifest=i,this.group=s,this.$element=e(),this.fields={}};u.getSelector=function(t){var r={selector:n,property:n};return t.selectors&&e.each(t.selectors,function(e,t){return r={selector:e,property:t[0]},!1}),r},u.prototype={constructor:u,build:function(){return this.$element.length&&this.panel.$fieldset.append(this.$element),this},getCss:function(e){var t=null,n=this.getSelector(),r=this.getElement();return!r.length||!e&&!n.property?null:(t=r.css(e?e:n.property),typeof t=="string"&&t.match(/^rgba?\(.*?\)$/)?this.getHexAlpha(t).hex:t)},updateCss:function(t,n){var r=this;arguments.length===1&&(n=t,t=n),e.each(this.manifest.selectors,function(e,i){var s=r.builder.$contents.find(e);if(!s.length)return!0;if(t)return s.css(t,n),!0;for(var o=0;o<i.length;o++)s.css(i[o],n)})},hasElement:function(t){var n=this,r=!1,i=t.get(0),s;return e.each(n.manifest.selectors,function(e,t){if(!(s=n.builder.$contents.find(e)).length)return!1;s.each(function(){if(this===i)return r=!0,!1})}),r},getElement:function(){var t=this.getSelector();return t.selector?this.builder.$contents.find(t.selector):e()},updateTextElement:function(e){this.getElement().text(e)},getHexAlpha:function(e){var t={hex:n,alpha:n},r=/rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:,\s*([\d\.]+))?/.exec(e);return r&&(t={hex:"#"+(1<<24|r[1]<<16|r[2]<<8|r[3]).toString(16).substr(1),alpha:r[4]}),t},getRgb:function(e){var t=parseInt(e.substr(1),16);return(t>>16&255)+", "+(t>>8&255)+", "+(t&255)},getSelector:function(){return u.getSelector(this.manifest)},setTitle:function(e){e.toggleClass("section_head",!this.manifest.weak_label).append(t.document.createTextNode(" "+this.manifest.name+":"))},change:function(){e.each(this.fields,function(e,t){t.change()})}};var a=function(t,n,i,s){var o=this;o.controls=new r,u.call(o,t,n,i,s),o.$element=e('<div class="control_group">'),s.customizations&&e.each(s.customizations,function(e,r){var i=f.get(t,n,e,r,o);o.controls.add(e,i),o.$element.append(i.$element)})};a.prototype=e.extend({},u.prototype,{constructor:a,change:function(){e.each(this.controls.items,function(e,t){t.change()})},hasElement:function(t){var n=!1;return this.controls.length&&e.each(this.controls.items,function(e,r){if(r.hasElement(t))return n=!0,!1}),n}});var f={controls:{},add:function(t,n){(!n||!e.isFunction(n.init)||!e.isFunction(n.check))&&e.error("Invalid control provided"),this.controls[t]=function(e,t,n,r,i){u.call(this,e,t,n,r,i)},this.controls[t].prototype=e.extend({},n,u.prototype,{constructor:this.controls[t]}),this.controls[t].check=n.check},get:function(t,n,r,i,s){s=s||{},i.name||e.error("Invalid control: no name provided");if(i.type==="group")return new a(t,n,r,i);var o=u;e.each(this.controls,function(e,t){if(t.check(i))return o=t,!1});var f=new o(t,n,r,i,s);return e.isFunction(f.init)&&f.init(),f}};f.add("4_sided_sizer",{check:function(t){return e.inArray(u.getSelector(t).property,["margin","padding"])!==-1},init:function(){var t=this,n=t.getSelector(),r,i;t.$element=e('<label class="label_input_grouped"><span class="primary_left"></span><input class="input_right sizer" type="number" min="0" max="100"></label><label class="label_input_grouped"><input class="input_right sizer" type="number" min="0" max="100"></label><label class="label_input_grouped"><input class="input_right sizer" type="number" min="0" max="100"></label><label class="label_input_grouped"><input class="input_right sizer" type="number" min="0" max="100"></label><span class="sizer_label">Top</span><span class="sizer_label">Right</span><span class="sizer_label">Bottom</span><span class="sizer_label">Left</span>'),e.each(["top","right","bottom","left"],function(s,o){i=n.property+"-"+o,r=t.getCss(i)||0,t.fields[i]=t.$element.eq(s).find("input.sizer").data("builder-property",i).val(parseInt(r,10)).change(e.proxy(t.sizeChange,t)).keyup(e.proxy(t.sizeKeyup,t)),l.get("initialize_sizers")(t.fields[i])}),t.setTitle(t.$element.find("span:first"))},sizeChange:function(t){return l.get("sizer_change")(t,this,e(t.currentTarget).data("builder-property"))},sizeKeyup:function(t){return l.get("sizer_keyup")(t,this,e(t.currentTarget).data("builder-property"))}}),f.add("background",{check:function(e){return u.getSelector(e).property==="background"},init:function(){var t=this.getCss("background-color")||"#000000";this.$element=e('<label class="label_input"><span class="primary_left"></span><input type="text" class="color_right color_picker"></label>'),this.fields.bgcolor=this.$element.find("input.color_picker").val(t),this.setTitle(this.$element.find("span:first")),l.get("colorpicker_initialize")(this,this.fields.bgcolor,"background-color")}}),f.add("border",{check:function(t){return e.inArray(u.getSelector(t).property,["border-top","border-bottom","border-left","border-right","border"])!==-1},init:function(){var t,r="",i=!1,s=this,o=s.getSelector(),u=s.getCss(o.property+"-style")||"none",a,f;e.each({None:"none",Dotted:"dotted",Dashed:"dashed",Solid:"solid",Double:"double",Groove:"groove",Ridge:"ridge",Inset:"inset",Outset:"outset"},function(e,t){r+='<option value="'+t+'" title="'+e+'">'+e+"</option>"}),s.updateCss(o.property+"-style","solid"),a=s.getCss(o.property+"-width")||"0",f=s.getCss(o.property+"-color")||"#000000",s.updateCss(o.property+"-style",u),s.$element=e('<label class="label_grouped_main"><span class="primary_left"></span><select class="combo_right combo_font select_field">'+r+"</select></label>"+'<label class="label_grouped"><input class="input_right size_field combo_color_and_size" type="text" min="0" max="20" value="13" maxlength="2"></label>'+'<label class="label_grouped"><input type="text" class="color_right color_picker"></label>'),this.$element.find("span:first").text(s.manifest.name+":"),s.fields={style:this.$element.find("select").val(u),width:this.$element.find("input.size_field").val(parseInt(a,10)),color:this.$element.find("input.color_picker").val(f)},e.each(["style","width","color"],function(e,t){s[t+"_property"]=o.property+"-"+t}),s.fields.style.change(e.proxy(s.styleChange,s)),l.get("initialize_sizers")(s.fields.width.change(e.proxy(s.widthChange,s)).keyup(e.proxy(s.widthKeyup,s))),l.get("colorpicker_initialize")(s,s.fields.color,s.color_property,n,e.proxy(s.colorChangeAll,s)),s.group&&(s.group.controls.length===0?(s.locked=!0,s.$lock=e('<img class="starter_icon border_lock" src="images/icons/padlock-closed.png" width="12" height="12">').wrap('<label class="label_grouped">').click(e.proxy(s.borderLock,s)),this.$element=this.$element.add(s.$lock).find("span:first").prepend(e("<b>").text(s.group.manifest.name+" ")).end()):l.get("border_initialize")(s))},widthChange:function(t){return l.get("sizer_change")(t,this,this.width_property,e.proxy(this.widthChangeAll,this))},widthKeyup:function(t){return l.get("sizer_keyup")(t,this,this.width_property,e.proxy(this.widthChangeAll,this))},widthChangeAll:function(e){return this.propertyUpdateAll("width_property","width",e)},styleChange:function(t){return l.get("select_change")(t,this,this.style_property,e.proxy(this.styleChangeAll,this))},styleChangeAll:function(e){return this.propertyUpdateAll("style_property","style",e)},colorChangeAll:function(e){return this.propertyUpdateAll("color_property","color",e)},propertyUpdateAll:function(t,n,r){var i=this;i.updateCss(i[t],r),n==="width"&&(r=parseInt(r,10)),i.locked&&e.each(i.group.controls.keys,function(e,t){if(t===i.name)return!0;i.group.controls.get(t).fields[n].val(r).change()})},borderLock:function(e){return l.get("border_lock")(e,this)}}),f.add("shadow",{check:function(e){return u.getSelector(e).property==="box-shadow"},init:function(){var t=this,r=t.getCss();t.$element=e('<div class="control_group shadow_group"> <label class="label_input_grouped"><span class="primary_left section_head"><input class="shadow_enabled shadow_checkbox" type="checkbox"></span></label> <label class="label_input_grouped"><input type="text" class="color_right color_picker shadow_color" value="#777777"></label> <label class="label_input_grouped"><input class="input_right shadow_size shadow_opacity" type="text" value="90" min="0" max="100" maxlength="3"><span class="shadow_text">%</span></label> <label class="label_input_grouped"><input class="input_right shadow_size shadow_x" type="text" value="2" min="0" max="10" maxlength="2"></label> <label class="label_input_grouped"><input class="input_right shadow_size shadow_y" type="text" value="2" min="0" max="10" maxlength="2"></label> <label class="label_input_grouped"><input class="input_right shadow_size shadow_blur" type="text" value="5" min="0" max="10" maxlength="2"></label> <span class="shadow_label first">Alpha</span><span class="shadow_label">X</span><span class="shadow_label">Y</span><span class="shadow_label">Blur</span></div>'),e.each(["checkbox","color","opacity","x","y","blur"],function(e,n){t.fields[n]=t.$element.find("input.shadow_"+n)}),t.setTitle(t.$element.find("span:first"));if(r&&r!=="none"){t.fields.checkbox.attr("checked","checked");var i=t.getHexAlpha(r);i.hex&&(t.fields.color.val(i.hex),t.fields.opacity.val(Math.round((i.alpha?i.alpha:1)*100)));var s=r.match(/(\d+)px\s+(\d+)px\s+(\d+)px\s+(\d+)px/);s&&(t.fields.x.val(s[1]),t.fields.y.val(s[2]),t.fields.blur.val(s[3]))}t.fields.checkbox.change(e.proxy(t.checkboxChange,t)).change(),l.get("colorpicker_initialize")(t,t.fields.color,n,{},e.proxy(t.shadowChange,t)),e.each(t.fields,function(n,r){n!=="checkbox"&&n!=="color"&&l.get("initialize_sizers")(r.change(e.proxy(t.sizerChange,t)).keyup(e.proxy(t.sizerKeyup,t)))})},sizerChange:function(t){return l.get("sizer_change")(t,this,n,e.proxy(this.shadowChange,this))},sizerKeyup:function(t){return l.get("sizer_keyup")(t,this,n,e.proxy(this.shadowChange,this))},shadowChange:function(){return l.get("shadow_change")(this)},checkboxChange:function(e){return l.get("shadow_checkbox")(this)}}),f.add("size",{check:function(e){return typeof e["default"]=="string"&&e["default"].match(/^\d+px$/)},init:function(){var t=this.manifest.options||[],n=t.min||"0",r=t.max||"1000",i=this.getCss()||t["default"]||n;this.$element=e('<label class="label_input"><span class="primary_left"></span><input type="number" class="input_right size_field"></label>'),this.fields.input=this.$element.find("input"),this.setTitle(this.$element.find("span:first")),l.get("initialize_sizers")(this.fields.input.attr({name:this.name,value:parseInt(i,10),min:n,max:r,maxlength:r.length}).change(e.proxy(this.inputChange,this)).keyup(e.proxy(this.inputKeyup,this)))},inputChange:function(e){return l.get("sizer_change")(e,this)},inputKeyup:function(e){return l.get("sizer_keyup")(e,this)}}),f.add("text",{check:function(e){return e.type==="text"},init:function(){var t=this.manifest.options||[],n="",r=this.getCss("font-family")||"Helvetica, Arial, sans-serif",i=this.getCss("font-size")||"13px",s=this.getCss("color")||"#000000",o=this.getElement();e.each({Arial:"Arial, Helvetica, sans-serif",Baskerville:"Baskerville, 'Times New Roman', Times, serif",Cambria:"Cambria, Georgia, Times, 'Times New Roman', serif","Century Gothic":"'Century Gothic', 'Apple Gothic', sans-serif",Consolas:"Consolas, 'Lucida Console', Monaco, monospace","Copperplate Light":"'Copperplate Light', 'Copperplate Gothic Light', serif","Courier New":"'Courier New', Courier, monospace","Franklin Gothic Medium":"'Franklin Gothic Medium', 'Arial Narrow Bold', Arial, sans-serif",Futura:"Futura, 'Century Gothic', AppleGothic, sans-serif",Garamond:"Garamond, 'Hoefler Text', 'Times New Roman', Times, serif",Geneva:"Geneva, 'Lucida Sans', 'Lucida Grande', 'Lucida Sans Unicode', Verdana, sans-serif",Georgia:"Georgia, Palatino, 'Palatino Linotype', Times, 'Times New Roman', serif","Gill Sans":"'Gill Sans', Calibri, 'Trebuchet MS', sans-serif",Helvetica:"Helvetica, Arial, sans-serif",Impact:"Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif","Lucida Sans":"'Lucida Sans', 'Lucida Grande', 'Lucida Sans Unicode', sans-serif",Palatino:"Palatino, 'Palatino Linotype', Georgia, Times, 'Times New Roman', serif",Tahoma:"Tahoma, Geneva, Verdana",Times:"Times, 'Times New Roman', Georgia, serif","Trebuchet MS":"'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif",Verdana:"Verdana, Geneva, Tahoma, sans-serif"},function(e,t){n+='<option value="'+t+'" title="'+t+'">'+e+"</option>"}),this.$element=e('<div class="control_group text_group"> <label class="label_input"><span class="primary_left"></span><input type="text" class="input_right description_text" maxlength="36"></label> <label class="label_grouped_main"><span class="primary_left">Font:</span><select class="combo_right combo_font select_field">'+n+"</select></label>"+' <label class="label_grouped"><input class="input_right size_field combo_color_and_size" type="text" min="8" max="80" maxlength="2"></label>'+' <label class="label_grouped"><input type="text" class="color_right color_picker"></label>'+"</div>"),this.fields={family:this.$element.find("select").val(r),size:this.$element.find("input.size_field").val(parseInt(i,10)),input:this.$element.find("input.description_text"),color:this.$element.find("input.color_picker").val(s)},this.setTitle(this.$element.find("span:first")),l.get("colorpicker_initialize")(this,this.fields.color,"color"),o.length?(this.fields.input.val(o.text()).change(e.proxy(this.textChange,this)).keyup(e.proxy(this.textChange,this)),this.fields.family.change(e.proxy(this.fontFamilyChange,this)),l.get("initialize_sizers")(this.fields.size.change(e.proxy(this.fontSizeChange,this)).keyup(e.proxy(this.fontSizeKeyup,this)))):e.each(this.fields,function(e,t){t.attr("disabled",!0)})},fontSizeChange:function(e){return l.get("sizer_change")(e,this,"font-size")},fontSizeKeyup:function(e){return l.get("sizer_keyup")(e,this,"font-size")},fontFamilyChange:function(e){return l.get("select_change")(e,this,"font-family")},textChange:function(e){return l.get("text_change")(e,this)}});var l={events:{},add:function(t,n){e.isFunction(n)||e.error("Invalid event provided"),this.events[t]=n},get:function(t){return e.isFunction(this.events[t])||e.error("Event doesn't exist: "+t),this.events[t]}};l.add("border_lock",function(t,n){var r={};n.locked=!n.locked,n.$lock.attr("src","images/icons/padlock-"+(n.locked?"closed":"open")+".png"),e.each(n.group.controls.keys,function(t,i){var s=n.group.controls.get(i);e.each(["width","style","color"],function(e,t){i===n.name?r[t]=s.fields[t].val():n.locked?s.fields[t].val(r[t]).change().attr("disabled",!0):s.fields[t].removeAttr("disabled")})})}),l.add("border_initialize",function(t){var n=t.group.controls.get(0);if(!n.locked)return;e.each(["width","style","color"],function(e,r){if(t.fields[r].val()!==n.fields[r].val())return n.$lock.click(),!1;t.fields[r].attr("disabled",!0)})}),l.add("colorpicker_initialize",function(t,r,i,s,o){var u=r.val()||"#000000",a=e('<div class="color_right fb-color-control"><div></div></div>').insertBefore(r).find("div").css("background-color",u);t.builder.$colorpick_blocker===n&&(t.builder.$colorpick_blocker=e('<div id="color_blocker"></div>').appendTo("body")),a.ColorPicker(e.extend({onChange:function(e,n,s){l.get("colorpicker_change")("#"+n,t,r,i,o)},onShow:function(n){return r.is(":disabled")||(t.builder.$colorpick_blocker.show(),e(n).fadeIn(500)),!1},onHide:function(n){return t.builder.$colorpick_blocker.hide(),e(n).fadeOut(500),!1}},s)).ColorPickerSetColor(u),r.change(function(){var n=e(this).val();a.ColorPickerSetColor(n),l.get("colorpicker_change")(n,t,r,i,o)})}),l.add("colorpicker_change",function(t,n,r,i,s){return r.val(t).prev(".fb-color-control").find("div").css("background-color",t),e.isFunction(s)?s(t):n.updateCss(i,t)}),l.add("subpanels_change",function(t,n){var r=(t.width-n.panels.length+1)/n.panels.length;e.each(n.panels.items,function(e,t){t.$title.removeClass("last").css("width",r+"px")}),n.panels.get(n.panels.length-1).$title.addClass("last")}),l.add("select_change",function(t,n,r,i){var s=e(t.currentTarget).val();return e.isFunction(i)?i(s):n.updateCss(r,s)}),l.add("shadow_change",function(t,n,r){if(!t.fields.checkbox.is(":checked"))return;var i="rgba("+t.getRgb(t.fields.color.val())+", "+t.fields.opacity.val()/100+") "+t.fields.x.val()+"px "+t.fields.y.val()+"px "+t.fields.blur.val()+"px 0";return e.isFunction(r)?r(i):t.updateCss(n,i)}),l.add("shadow_checkbox",function(t,n,r){var i=t.fields.checkbox.is(":checked");return e.each(t.fields,function(e,t){e!=="checkbox"&&t.attr("disabled",!i)}),i?l.get("shadow_change")(t,n,r):t.updateCss(n,"none")}),l.add("initialize_sizers",function(t){t.each(function(){var t=e(this);t.data("oldvalue",t.val())})}),l.add("sizer_change",function(t,n,r,i){var s=e(t.currentTarget),o=parseInt(s.attr("min"),10),u=parseInt(s.attr("max"),10),a=s.val();return/^\d+$/.test(a)?(a=parseInt(a,10),!isNaN(o)&&a<o?l.get("sizer_reset")(t,n,r,i,"The minimum allowed value is "+o+"."):!isNaN(u)&&a>u?l.get("sizer_reset")(t,n,r,i,"The maximum allowed value is "+u+"."):(s.data("oldvalue",a),e.isFunction(i)?i(a+"px"):n.updateCss(r,a+"px"))):l.get("sizer_reset")(t,n,r,i)}),l.add("sizer_keyup",function(t,n,r,i){var s=e(t.currentTarget),o=parseInt(s.attr("min"),10),u=parseInt(s.attr("max"),10),a=s.val();if(!/^\d+$/.test(a))return;a=parseInt(a,10);if(!isNaN(o)&&a<o||!isNaN(o)&&a>u)return;return e.isFunction(i)?i(a+"px"):n.updateCss(r,a+"px")}),l.add("sizer_reset",function(t,n,r,i,s){var o=e(t.currentTarget),u=o.data("oldvalue")||parseInt(n.getCss(r),10)||0;return typeof s=="string"&&alert(s),o.val(u),e.isFunction(i)?i(u+"px"):n.updateCss(r,u+"px")}),l.add("text_change",function(t,n,r){var i=e(t.currentTarget).val();return e.isFunction(r)?r(i):n.updateTextElement(i)}),l.add("window_resize",function(t,n,r){n.$center.width(e(t.currentTarget.document).width()-n.width),e.isFunction(r)&&r()});var c=["activatePanel","activateSubPanel","addPanel","change","disable","enable","next","prev","refresh","removePanel","toggleDesignMode","addSubPanel","addControlToPanel","addControlToSubPanel","removeSubPanel","removeControlFromPanel","removeControlFromSubPanel"],h={events:{object:l,methods:["add"]},controls:{object:f,methods:["add"]}};e.fn.coffeeBuilder=function(t){var n=this.data("coffeeBuilder");return n||this.data("coffeeBuilder",n=new i(this,t)),typeof t=="string"&&(e.inArray(t,c)!==-1?n[t].apply(n,Array.prototype.slice.call(arguments,1)):e.error("Method "+t+" does not exist on jQuery.fn.coffeeBuilder")),this},e.coffeeBuilder=function(t){var n=e(t);return n.coffeeBuilder.apply(n,Array.prototype.slice.call(arguments,1))},e.each(h,function(t,n){e.coffeeBuilder[t]=function(r){if(e.inArray(r,n.methods)!==-1)return n.object[r].apply(n.object,Array.prototype.slice.call(arguments,1));e.error("Method "+r+" does not exist on jQuery.coffeeBuilder."+t)}})}(jQuery,window);